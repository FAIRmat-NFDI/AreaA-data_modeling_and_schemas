definitions:
  name: 'Float Zone schema' 
  sections: 
    FZ_IKZ_process: 
      base_section: ../upload/raw/base_classes.schema.archive.yaml#Process
      m_annotations:
        eln:
          dict()
      sub_sections:
        instrument:
          section:
            quantities:
              furnace_type:
                type: 
                  type_kind: Enum
                  type_data:
                    - "1505/1"  
                    - "1505/2"
                description: "Furnace description"
                m_annotations:
                  eln:
                    component: EnumEditQuantity
              vacuum_before_process_HV:
                type: np.float64
                unit: mbar
                m_annotations:
                  eln:
                    component: NumberEditQuantity
                    defaultDisplayUnit: mbar
                description: "Pressure"
              furnace_leak_rate:
                type: 
                  type_kind: Enum
                  type_data:
                    - good
                    - bad
                description: "Furnace leak rate"
                m_annotations:
                  eln:
                    component: EnumEditQuantity
            sub_sections:
              inductor:
                section:
                  quantities:
                    inductor_id:
                      type: str
                      description: "what is the inductor id?"
                      m_annotations:
                        eln:
                          component: StringEditQuantity
                    inductor_drawing: 
                      type: str
                      description: "Drawing of inductor"
                      m_annotations:
                        eln:
                          component: RichTextEditQuantity
              reflector:
                section:
                  quantities:
                    reflector_id:
                      type: str
                      description: "what is the inductor id?"
                      m_annotations:
                        eln:
                          component: StringEditQuantity
                    reflector_inductor_position:
                      type: np.float64
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
        materials:
          section:
            m_annotations:
              eln:
                dict()
            sub_sections:
              gases:
                repeats: true
                #m_annotations:
                #  eln:
                section:
                  m_annotations:
                    eln:
                  quantities:
                    gas_name:
                      type: 
                        type_kind: Enum
                        type_data:
                          - Ar 
                          - N2 from pipeline
                          - N2 from balloon
                          - H2
                      description: "name/type of gas"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                  sub_sections:
                    SampleID:
                      section:
                        base_sections:
                          - 'nomad.datamodel.metainfo.eln.SampleID'
                          - 'nomad.datamodel.data.EntryData'
                        m_annotations:
                          template: 
                          eln: 
                            # hide: ['children', 'parents']
                            # hide: ['children', 'parents', institute]
                            hide: []
              dopants:
                repeats: true
                #m_annotations:
                #  eln:
                section:
                  m_annotations:
                    eln:
                  quantities:
                    dopant_name:
                      type:
                        type_kind: Enum
                        type_data:
                          - PH3
                          - Boron
                      description: "name/type of dopant"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                      type: str
                      description: "name/type of dopant"
                      m_annotations:
                        eln:
                          component: StringEditQuantity
                    dopant_id:
                      type: str
                      description: "what is the dopant id?"
                      m_annotations:
                        eln:
                          component: StringEditQuantity
                  sub_sections:
                    SampleID:
                      section:
                        base_sections:
                          - 'nomad.datamodel.metainfo.eln.SampleID'
                          - 'nomad.datamodel.data.EntryData'
                        m_annotations:
                          template: 
                          eln: 
                            # hide: ['children', 'parents']
                            # hide: ['children', 'parents', institute]
                            hide: []
              feed_rod:
                section:
                  quantities:
                    material: 
                      type: 
                        type_kind: Enum
                        type_data:
                          - Wacker
                          - ASIMI 
                          - REC 
                          - other                        
                      description: "feed rod material options"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    diameter:
                      type: np.float64
                      description: "diameter of feed rod"
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    rod_surface: 
                      type: 
                        type_kind: Enum
                        type_data:
                          - round grinded
                          - raw
                      description: "rod surface condition"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    rod_pretreatment:
                      type: 
                        type_kind: Enum
                        type_data:
                          - etched
                          - raw
                          - US cleaned
                      description: "rod pretreatment"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    rod_position_during_preheating:
                      type: np.float64
                      description: "position of rod during preheating"
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                  sub_sections:
                    SampleID:
                      section:
                        base_sections:
                          - 'nomad.datamodel.metainfo.eln.SampleID'
                          - 'nomad.datamodel.data.EntryData'
                        m_annotations:
                          template: 
                          eln: 
                            # hide: ['children', 'parents']
                            # hide: ['children', 'parents', institute]
                            hide: []
        process:
          section:
            m_annotations:
              eln:
                dict()
            sub_sections:
              gas_ambient_settings:
                repeats: true
                section:
                  # m_annotations:
                  #   eln:
                  quantities:
                    timestamp:
                      type: Datetime
                      m_annotations:
                        eln:
                          component: DateTimeEditQuantity
                    process_type:
                      type: 
                        type_kind: Enum
                        type_data:
                          - pre
                          - main 
                          - post 
                      description: "choose type of process"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    process_note:
                      type: str
                      description: "Text field for any process notes"
                      m_annotations:
                        eln:
                          component: RichTextEditQuantity
                    #gas_ambient:
                    #  section:
                    #    quantities:
                    gas_pressure:
                      type: np.float64
                      description: "where is this gas pressure measured? "
                      unit: mbar
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mbar
                    Ar_inflow_rate:
                      type: np.float64
                      description: "Ar inflow rate measured at ???"
                      unit: cm/minute
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: cm/minute
                    gas_outflow_rate:
                      type: np.float64
                      description: "gas outflow rate measured at ???"
                      unit: cm/minute
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: cm/minute
                    N2_Gas_composition:
                      type: np.float64
                      description: "Ar inflow rate measured at ???"
                      unit: m
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: m
                        #sub_sections:
                        #  doping:
                        #    section:
                        #      quantities:
                    dopant:
                      type: 
                        type_kind: Enum
                        type_data:
                          - PH3
                          - B2H6
                      description: "doping type"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    doping_concentration:
                      type: 
                        type_kind: Enum
                        type_data:
                          - "0"
                          - "1" 
                          - "10"
                          - "100"
                          - "500"
                      description: "applied doping concentration in ppm"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
              process_settings:
                repeats: true
                section:
                  # m_annotations:
                  #   eln:
                  quantities:
                    timestamp:
                      type: Datetime
                      m_annotations:
                        eln:
                          component: DateTimeEditQuantity
                    process_type:
                      type: 
                        type_kind: Enum
                        type_data:
                          - pre
                          - main 
                          - post 
                      description: "choose type of process"
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    process_note:
                      type: str
                      description: "Text field for any process notes"
                      m_annotations:
                        eln:
                          component: RichTextEditQuantity
                    process_step_name:
                      type:
                        type_kind: Enum
                        type_data:
                          - process preparation
                          - rod preheating
                          - rod glowing
                          - melting
                          - back-melting
                          - dash-neck
                          - transition to cone
                          - cone growing 
                          - crystal body
                          - operation of crystal support system
                          - process end
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    comment:
                      type: str
                      description: "comment related to process setting"
                      m_annotations:
                        eln:
                          component: StringEditQuantity
                    rod_preheating_method: 
                      type:   
                        type_kind: Enum
                        type_data:
                          - IR
                          - Graphite preheater
                          - Molibdenum preheater 
                          - other
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    rod_preheating_voltage:
                      type: np.float64
                      description: "Voltage from preheating system"
                      unit: V
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: V
                    rod_preheating_duration:
                      type: np.float64
                      description: "Voltage from preheating system"
                      unit: V
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: V
                    voltage:
                      type: np.float64
                      description: "Voltage from software controlled system"
                      unit: kV
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: kV # is it always the same voltage?
                    coil_offset: 
                      type: np.float64
                      description: "coil offset can be set manually "
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    upper_pull_speed_rod: 
                      type: np.float64
                      description: "fill out"
                      unit: mm/minute
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm/minute
                    lower_pull_speed_crystal: 
                      type: np.float64
                      description: "fill out"
                      unit: mm/minute
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm/minute
                    upper_rotation_rod: 
                      type: np.float64
                      description: "fill out"
                      unit: 1/minute
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: 1/minute
                    lower_rotation_crystal: 
                      type: np.float64
                      description: "fill out"
                      unit: 1/minute
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: 1/minute
                    neck_length: 
                      type: np.float64
                      description: "fill out"
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    switching_to_software_process_control: 
                      type: bool
                      description: "check for yes / uncheck for no"
                      m_annotations:
                        eln:
                          component: BoolEditQuantity
                    lower_position_crystal: 
                      type: np.float64
                      description: "fill out"
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    upper_position_rod: 
                      type: np.float64
                      description: "fill out"
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    #back-melting_start_voltage: # same voltage as in protocol, but before you write the protocol
                    #back-melting_end voltage [kV]: # same voltage as in protocol but before you write the protocol
                    #start_voltage [kV]: # same voltage as in protocol but before you write the protocol
                    #maximum_voltage [kV]: # same voltage as in protocol but before you write the protocol
                    #minimum_voltage [kV]: # same voltage as in protocol but before you write the protocol
              digital_protocol:
                section:
                  base_section: nomad.parsing.tabular.TableData
                  m_annotations:
                    eln:
                      #dict()
                    plot:
                    - label: control_parameter_set
                      x: "timestamp"
                      y: 
                        - control_parameter_set
                    - label: lower_diameter_crystal
                      x: "timestamp"
                      y: 
                        - lower_diameter_crystal 
                    - label: zone_height
                      x: "timestamp"
                      y: 
                        - zone_height
                    - label: upper_pull_speed_rod
                      x: "timestamp"
                      y: 
                        - upper_pull_speed_rod
                    - label: control parameter set vs. lower diamenter crystal
                      x: "lower_diameter_crystal"
                      y: control_parameter_set #["./control_parameter_set", "./lower_diameter_crystal", "./zone_height", "./upper_pull_speed_rod"]
                    - label: all time-dependent data
                      x: "timestamp"
                      y: 
                        - control_parameter_set 
                        - lower_diameter_crystal 
                        - zone_height
                        - upper_pull_speed_rod                  

                    # - label: time-dependent data plot
                    #   x: timestamp
                    #   y: 
                    #     - control_parameter_set
                    #     - lower_diameter_crystal
                    #     - zone_height
                    #     - upper_pull_speed_rod
                  quantities:
                    data_file:
                      type: str
                      description: |
                        A reference to an uploaded .xlsx
                      m_annotations:
                        # The tabular_parser annotation, will treat the values of this
                        # quantity as files. It will try to interpret the files and fill
                        # quantities in this section (and sub_section) with the column
                        # data of .csv or .xlsx files.
                        tabular_parser:
                          # sep: ','
                          comment: '#'
                        browser:
                          adaptor: RawFileAdaptor  # Allows to navigate to files in the data browser
                        eln:
                          component: FileEditQuantity  # A form field that allows to drop and select files.
                    measurment_no:
                      type: np.float64
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Index
                    # date:
                    #   type: str
                    #   shape: ['*']
                    #   m_annotations:
                    #     tabular:
                    #       name: Datum
                    timestamp:
                      type: Datetime
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Datum_Zeit
                    upper_position_rod:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: PosHubOb
                    upper_pull_speed_rod:
                      type: np.float64
                      unit: millimeter/minute
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: SollHubOb
                    upper_rotation_rod:
                      type: np.float64
                      unit: 1/minute
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: SollRotOb
                    lower_position_crystal:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: PosHubUnt
                    lower_pull_speed_crystal:
                      type: np.float64
                      unit: millimeter/minute
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: SollHubUnt
                    lower_rotation_crystal:
                      type: np.float64
                      unit: 1/minute
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: SollRotUnt
                    control_parameter:
                      type: str
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Betr.Art
                    control_parameter_set:
                      type: np.float64
                      unit: kV
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Gen-Soll
                    power_obtained:
                      type: np.float64
                      unit: kW
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: P-Ist
                    current_obtained:
                      type: np.float64
                      unit: A
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Ia-Ist
                    voltage_obtained:
                      type: np.float64
                      unit: kV
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Ua-Ist
                    grid_current:
                      type: np.float64
                      unit: A
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Ig-Ist
                    high_frequency_current:
                      type: np.float64
                      unit: A
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: I-hf
                    high_frequency_voltage:
                      type: np.float64
                      unit: kV
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: U-hf
                    frequency:
                      type: np.float64
                      unit: MHz
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: f-HF
                    inner_mechanisms_position_arbkr:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Pos-Arbkr
                    inner_mechanisms_position_spindel:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Pos-Spindel
                    inner_mechanisms_position_nachheizen:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: Pos-Nachheiz
                    upper_diameter_rod:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: DurchmObn
                    lower_diameter_crystal:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: DurchmUnt
                    zone_height:
                      type: np.float64
                      unit: millimeter
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: ZonenHo
                    meniscus_angle_on_left_side:
                      type: np.float64
                      unit: degree
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: WinkelLi
                    meniscus_angle_on_right_side:
                      type: np.float64
                      unit: degree
                      shape: ['*']
                      m_annotations:
                        tabular:
                          name: WinkelRe
              basic_crystal_characterization:
                repeats: true
                section:
                  # m_annotations:
                  #   eln:
                  quantities:
                    diameter_target_crystal:
                      type: np.float64
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    diameter_measured_crystal: 
                      type: np.float64
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    body_diameter:
                      type: np.float64
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    body_length:
                      type: np.float64
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    process_conclusion:
                      type: str
                      description: "Comments and conclusion on the crystal growth process"
                      m_annotations:
                        eln:
                          component: RichTextEditQuantity
              resistivity:
                repeats: true
                section:
                  # m_annotations:
                  #   eln:
                  quantities:
                    target_resistivity:
                      type: np.float64
                      unit: ohm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: ohm
                    maximum_resistivity_on_body:
                      type: np.float64
                      unit: ohm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: ohm
                    minimum_resistivity_on_body:
                      type: np.float64
                      unit: ohm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: ohm
                    measurement_protocol:
                      type: str
                      description: "drop the LPS map here"
                      m_annotations:
                        eln:
                          component: RichTextEditQuantity
              lifetime:
                repeats: true
                section:
                  # m_annotations:
                  #   eln:
                  quantities:
                    average_lifetime_on_body:
                      type: np.float64
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    lifetime_map:
                      type: str
                      description: "drop the lifetime map here"
                      m_annotations:
                        eln:
                          component: RichTextEditQuantity
              lateral_photovoltage_scanning:
                repeats: true
                section:
                  # m_annotations: 
                  #   eln:
                  quantities:
                    interface_curvative:
                      type: np.float64
                      unit: mm
                      m_annotations:
                        eln:
                          component: NumberEditQuantity
                          defaultDisplayUnit: mm
                    LPS_map:
                      type: str
                      description: "drop the LPS map here"
                      m_annotations:
                        eln:
                          component: RichTextEditQuantity

                        
